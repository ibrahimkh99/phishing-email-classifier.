# Phishing Email Classifier

Lightweight TF‑IDF + Logistic Regression classifier for detecting phishing emails, with a small Flask web UI and simple security-cue heuristics. Intended as an educational project and a starting point for experimenting with text-based phishing detection.

## Quick start

Prerequisites
- Python 3.10+ (3.11 tested)
- Git (to clone the repository)

Windows (PowerShell)
```powershell
git clone https://github.com/ibrahimkh99/phishing-email-classifier.git
cd phishing-email-classifier
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
```

macOS / Linux
```bash
git clone https://github.com/ibrahimkh99/phishing-email-classifier.git
cd phishing-email-classifier
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

Quick run (no training required)

If you just want to run the web UI and try the classifier, the repository already includes a cleaned dataset and a saved model. You can skip data preparation and training.

Windows (PowerShell)
```powershell
git clone https://github.com/ibrahimkh99/phishing-email-classifier.git
cd phishing-email-classifier
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt

# Start the web UI (uses the saved model in `models/`)
python app.py runserver --host 127.0.0.1 --port 5000
```

macOS / Linux
```bash
git clone https://github.com/ibrahimkh99/phishing-email-classifier.git
cd phishing-email-classifier
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python app.py runserver --host 127.0.0.1 --port 5000
```

Open `http://127.0.0.1:5000` in your browser.

## Project structure

```
phishing-email-classifier/
├─ app.py                      # Main Flask app + CLI entrypoints
├─ model_utils.py              # Small helpers for saving/loading model
├─ data/
│  └─ clean_phishing_emails.csv  # Cleaned dataset (generated by prepare-data)
├─ models/
│  └─ phishing_model.joblib      # Trained model (joblib pipeline)
├─ static/
│  └─ style.css               # Web UI CSS
├─ templates/
│  └─ index.html              # Jinja2 template for UI
├─ requirements.txt
└─ README.md
```

## Dataset

This project uses the Kaggle dataset "Phishing Email Detection" by `subhajournal`.
If you want to retrain the model from the Kaggle dataset, see the **For developers (prepare & train)** section below. Otherwise the repository contains a cleaned dataset and a saved model so you can run the app immediately.

## Model & training

The training pipeline uses `TfidfVectorizer` (unigrams + bigrams) and `LogisticRegression` with `class_weight='balanced'`. Labels are encoded as `phishing`→1 and `ham`→0.

CLI commands
- `python app.py train` — trains and saves `models/phishing_model.joblib`
- `python app.py evaluate` — evaluates the saved model on the cleaned dataset and prints accuracy, classification report, and confusion matrix
- `python app.py predict --text "..."` — quick CLI prediction

## For developers (prepare & train)

If you want to prepare your own copy of the Kaggle CSV or retrain the model, follow these steps.

1. Place the downloaded raw CSV in `data/`, e.g. `data/phishing_emails_raw.csv`.

2. Run the prepare step to create the cleaned CSV:

```powershell
python app.py prepare-data data/phishing_emails_raw.csv --output-csv data/clean_phishing_emails.csv
```

The prepare step will:
- auto-detect text/label columns (with heuristics)
- normalize labels to `phishing` and `ham`
- output `data/clean_phishing_emails.csv` with columns `label,text`

3. (Optional) Train the model locally:

```powershell
python app.py train --csv data/clean_phishing_emails.csv --model models/phishing_model.joblib
```

After training you can evaluate with `python app.py evaluate` and run the UI as described above.

## Web UI

The Flask web UI allows pasting an email, runs the model, and displays:
- Predicted label and probabilities
- Simple heuristic security cues (multiple links, urgent words, sensitive keywords, exclamation usage)

Run the UI:
```powershell
python app.py runserver --host 127.0.0.1 --port 5000
```

## Notes about the model file

The repository currently contains a saved model at `models/phishing_model.joblib`. This is useful for quickly running the app, but the file is large and can bloat the git history. Alternatives:
- Remove the model from the repo and use GitHub Releases to attach the model as a release asset.
- Use Git LFS to track large binaries.

If you prefer not to commit the model, run:
```powershell
git rm --cached models/phishing_model.joblib
echo "models/" >> .gitignore
git add .gitignore
git commit -m "Do not track models/; use releases or LFS for model artifacts"
git push
```

## Troubleshooting

- If the server cannot load the model: ensure `models/phishing_model.joblib` exists and `joblib` is installed in your venv.
- If `pandas`/`scikit-learn` imports fail: activate your venv and run `pip install -r requirements.txt`.
- On Windows PowerShell, use `venv\Scripts\activate` to activate the virtual environment.

## Disclaimer

This project is for educational purposes only. The model is trained on a specific dataset and may not generalize to all phishing attempts. Do not rely solely on this tool for real-world security decisions.

## Contributions

Contributions are welcome. Open an issue or submit a pull request with improvements.

## License

This repository is provided under the MIT License. See `LICENSE` for details.
